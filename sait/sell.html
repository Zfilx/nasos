<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ù–∞—Å–æ—Å–î–æ–º ‚Äî –û–±—Ä–∞—Ç–Ω—ã–π –∑–≤–æ–Ω–æ–∫</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #f9fbfd;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            background: #ffffff;
            border-radius: 12px;
            padding: 40px;
            max-width: 420px;
            width: 90%;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        h1 {
            color: #1846c7;
            margin-bottom: 16px;
        }

        p {
            color: #555;
            font-size: 16px;
            margin-bottom: 24px;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        label {
            font-size: 14px;
            color: #333;
            display: block;
            margin-bottom: 6px;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 14px;
        }

        button {
            background-color: #1e63f3;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 10px;
        }

            button:hover {
                background-color: #1846c7;
            }

        .confirmation {
            display: none;
            color: green;
            font-weight: bold;
            margin-top: 20px;
        }

        .error-message {
            color: red;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–ù–∞—Å–æ—Å–î–æ–º</h1>
        <p>–û—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π –∫–æ–Ω—Ç–∞–∫—Ç, –∏ –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏!</p>
        <div class="input-group">
            <label for="name">–ò–º—è</label>
            <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è" />
        </div>
        <div class="input-group">
            <label for="city">–ì–æ—Ä–æ–¥</label>
            <select id="city">
                <option value="–ú–æ—Å–∫–≤–∞">–ú–æ—Å–∫–≤–∞</option>
                <option value="–ö–∞–∑–∞–Ω—å">–ö–∞–∑–∞–Ω—å</option>
                <option value="–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                <option value="–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫</option>
                <option value="–î—Ä—É–≥–æ–π">–î—Ä—É–≥–æ–π</option>
            </select>
        </div>
        <div class="input-group">
            <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="tel" id="phone" placeholder="+7 (___) ___-__-__" required />
            <div class="error-message" id="phone-error"></div>
        </div>
        <button onclick="submitForm()">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        <div class="confirmation" id="confirmation">
            –°–ø–∞—Å–∏–±–æ! –ú—ã —Å–∫–æ—Ä–æ –≤–∞–º –ø–µ—Ä–µ–∑–≤–æ–Ω–∏–º.
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const phoneInput = document.getElementById('phone');
            const phoneError = document.getElementById('phone-error');

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º +7 –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
            phoneInput.addEventListener('focus', function () {
                if (!phoneInput.value.startsWith('+7')) {
                    phoneInput.value = '+7';
                }
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            phoneInput.addEventListener('input', function (e) {
                let value = phoneInput.value;

                // –£–¥–∞–ª—è–µ–º –≤—Å–µ, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä –∏ +
                value = value.replace(/[^\d+]/g, '');

                // –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –Ω–∞—á–∞–ª–æ —Å +7
                if (!value.startsWith('+7')) {
                    value = '+7' + value.replace(/^\+?[78]?/, '');
                }

                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É (1 –¥–ª—è + –∏ 1 –¥–ª—è 7 –∏ 10 —Ü–∏—Ñ—Ä)
                if (value.length > 12) {
                    value = value.substring(0, 12);
                }

                // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞: +7 (XXX) XXX-XX-XX
                if (value.length > 2) {
                    let num = value.substring(2);
                    num = num.replace(/\D/g, '');
                    let formatted = '+7';

                    if (num.length > 0) {
                        formatted += ' (' + num.substring(0, 3);
                    }
                    if (num.length > 3) {
                        formatted += ') ' + num.substring(3, 6);
                    }
                    if (num.length > 6) {
                        formatted += '-' + num.substring(6, 8);
                    }
                    if (num.length > 8) {
                        formatted += '-' + num.substring(8, 10);
                    }

                    value = formatted;
                }

                phoneInput.value = value;
            });

            // –ó–∞–ø—Ä–µ—â–∞–µ–º –≤–≤–æ–¥ –±—É–∫–≤ –∏ –¥—Ä—É–≥–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
            phoneInput.addEventListener('keypress', function (e) {
                const char = String.fromCharCode(e.which || e.keyCode);
                if (!/[\d+]/.test(char) ||
                    (char === '+' && phoneInput.value.includes('+'))) {
                    e.preventDefault();
                }
            });
        });

        function submitForm() {
            const name = document.getElementById('name').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const city = document.getElementById('city').value;
            const phoneError = document.getElementById('phone-error');

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç—ã–µ –ø–æ–ª—è
            if (!name || !phone) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞: +7 –∏ —Ä–æ–≤–Ω–æ 10 —Ü–∏—Ñ—Ä
            const digits = phone.replace(/\D/g, '').substring(1); // –£–±–∏—Ä–∞–µ–º +7
            if (digits.length !== 10) {
                phoneError.textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (+7 –∏ 10 —Ü–∏—Ñ—Ä)';
                phoneError.style.display = 'block';
                return;
            } else {
                phoneError.style.display = 'none';
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
            document.getElementById('confirmation').style.display = 'block';

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram, –µ—Å–ª–∏ –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ
            const product = sessionStorage.getItem('selectedProduct');
            const price = sessionStorage.getItem('selectedPrice');

            if (product && price) {
                sendToTelegram(product, price, name, phone, city);
            }
        }

        function sendToTelegram(productName, price, fullName, phoneNumber, city) {
            const token = '8014534507:AAEXQ-MGWgjMF2RIz-1Mt5rOYNbypnWyoVM';
            const chatId = '7990654547';
            const message = `üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑:\n\nüì¶ –¢–æ–≤–∞—Ä: ${productName}\nüí∞ –¶–µ–Ω–∞: ${price}\nüèô –ì–æ—Ä–æ–¥: ${city}\nüë§ –ö–ª–∏–µ–Ω—Ç: ${fullName}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phoneNumber}`;
            const url = `https://api.telegram.org/bot${token}/sendMessage`;

            fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: chatId, text: message })
            }).then(response => {
                if (!response.ok) {
                    console.error('–û—à–∏–±–∫–∞ Telegram:', response.statusText);
                }
            });
        }
    </script>
</body>
</html>